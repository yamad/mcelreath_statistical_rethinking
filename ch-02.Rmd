```{r 2.1}
ways <- c(0, 3, 8, 9, 0)
ways / sum(ways)
```

```{r 2.2}
dbinom(6, size=9, prob=0.5)
```

```{r 2.3}
## define grid
p_grid <- seq(from=0, to=1, length.out=20)

## define prior
prior <- rep(1, 20)

## compute likelihood at each value in grid
likelihood <- dbinom(6, size=9, prob=p_grid)

## compute product of likelihood and prior
unstd.posterior <- likelihood * prior

## standardize the posterior, so it sums to 1
posterior <- unstd.posterior / sum(unstd.posterior)
```

```{r 2.4}
plot(p_grid, posterior, type="b",
     xlab="probability of water", ylab="posterior probability")
```

```{r 2.6}
library(rethinking)
globe.qa <- map(
  alist(
    w ~ dbinom(9,p),                    # binomial likelihood
    p ~ dunif(0,1)                      # uniform prior
  ),
  data=list(w=6))

precis(globe.qa)
```

```{r 2.7}
# analytical calculation
w <- 6
n <- 9
curve(dbeta(x, w+1, n-w+1), from=0, to=1)
# quadratic approximation
curve(dnorm(x, 0.67, 0.16), lty=2, add=TRUE)
```

## 2.6 Practice

### Easy

  - 2E1. Pr(rain|Monday), Pr(rain,Monday) / Pr(Monday), (the
    probability of rain on Monday)
  - 2E2. (3) The probability that it is Monday, given that it is
    raining (Pr(Monday|rain))
  - 2E3. (1) Pr(Monday|rain), (4) Pr(rain|Monday) Pr(Monday) /
    Pr(rain) (the probability that it is Monday, given that it is
    raining)
  - 2E4. "The probability of water is 0.7" describes a belief (a
    willingness to bet, for instance) about the chances/likelihood
    that a single sample of a point on the globe will result in water.

### Medium

#### 2M1

Compute/plot grid approximation of posterior distribution for each set of observations

```{r ex-2M1}
grid_approx <- function(obs, prior) {
  obs_list <- strsplit(obs, " ")[[1]]
  nwater <- sum(obs_list == 'W')
  n <- length(obs_list)

  p_grid <- seq(from=0, to=1, length.out=20)
  likelihood <- dbinom(nwater, size=n, prob=p_grid)
  unstd.posterior <- likelihood * sapply(p_grid, prior)
  posterior <- unstd.posterior / sum(unstd.posterior)

  plot(p_grid, posterior, type='b',
       xlab="probability of water", ylab="posterior probability")
  title(obs)
}

samples <- c(
  "W W W",
  "W W W L",
  "L W W L W W W"
)
par(mfrow=c(1, 3))

prior <- function(p) { 1 }
sapply(samples, function(obs) {
  grid_approx(obs, prior)
  })
```

### 2M2

```{r ex-2M2}
prior <- function(p) {
  if (p < 0.5)  0
  else          1
}
sapply(samples, function(obs) {
  grid_approx(obs, prior)
  })
```

### 2M3

```{r ex-2M3}
p_land_earth <- 0.3
p_land_mars <- 1

p_earth <- 0.5
p_mars <- 0.5
p_land <- sum(c(p_land_earth, p_land_mars) * c(p_earth, p_mars))

# pr(earth|land) <- (pr(land|earth) pr(earth)) / pr(land)
p_earth_land <- (p_land_earth * p_earth) / p_land
p_earth_land
```
